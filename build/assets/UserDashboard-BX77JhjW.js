import{A as P,r as l,k as $,j as e}from"./index-BTeMt0bn.js";import{a as h,b as n}from"./api-4LTkHDOH.js";import{C as g}from"./index-B6O0b9K5.js";import{B as M}from"./button-TQMUHxtX.js";import{R as V}from"./FilePdfOutlined-Ckvf7fcD.js";import"./AntdIcon-C60h6qUe.js";import"./compact-item-BhS0uAM4.js";const R=()=>{var x,N,u,f;const r=P(),[m,b]=l.useState({}),[a,_]=l.useState(null),[j,E]=l.useState([]),[y,D]=l.useState([]),[C,w]=l.useState(!0),[A,F]=l.useState(!0),p=$();l.useEffect(()=>{if(r===!1){window.location.href="/login";return}},[r]),l.useEffect(()=>{const s=r.role;h.get(`${n}/admistration/roleaccessbyroleid/${s}`).then(t=>{const o=t.data.data.some(c=>c.MODULE_MST_ID===7);p(o?"/userdashboard":"/dashboard")}).catch(t=>{console.error("Error fetching role data:",t.message)})},[]),l.useEffect(()=>{r!=null&&r.employee_id&&h.get(`${n}/setting/employee/byId/${r.employee_id}`).then(s=>{b(s.data.data[0])}).catch(s=>alert(s.message))},[]),l.useEffect(()=>{h.get(`${n}/userdeshboard/${r.employee_id}`).then(s=>_(s.data.data)).catch(s=>alert(s.message))},[]),console.log(a),l.useEffect(()=>{(async()=>{var t,i;try{const c=(await h.get(`${n}/deshboardUserChart/${r.employee_id}`)).data.data,T=[["Document Type","Number of Files",{role:"style"}],...((t=c==null?void 0:c.CategoryGraph)==null?void 0:t.map((d,S)=>[d.DOC_TYPE_NAME,d.NO_OF_FILES,["#D9524E","#F77C40","#2BAAE1","#93C54A","#76a7fa"][S%5]]))||[]];E(T),w(!1);const L=(i=c==null?void 0:c.departmentPie)==null?void 0:i.map(d=>[d.DEPT_NAME,d.NO_OF_FILES]);D([["Department","Number of Files"],...L||[]]),F(!1)}catch(o){alert(o.message)}})()},[]);const v=(s,t)=>{h.post(`${n}/deshboard/totalViewDownloadCount`,{FILE_ID:s,FILE_NAME:t,VIEW_YN:"Y",DOWNLOAD_YN:"N"})},O={title:"Document Types and File Counts",hAxis:{title:"Document Type",textStyle:{fontName:"Poppins"}},vAxis:{title:"Number of Files",textStyle:{fontName:"Poppins"}},legend:"none",chartArea:{width:"80%",height:"70%"}},I={title:"Files per Department",legend:{position:"right",alignment:"center"}};return r===!1||!a?e.jsx("div",{className:"spinner-border mt-4",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("h5",{className:"text-primary",children:["Hello ",m==null?void 0:m.EMP_NAME," !!"]})}),e.jsx("div",{className:"row",children:[{count:(x=a==null?void 0:a.totalCount)==null?void 0:x.NO_OF_ACTIVE_USERS,label:"Users",color:"#D9524E",icon:"fa-users"},{count:(N=a==null?void 0:a.totalCount)==null?void 0:N.TOT_NO_OF_FILES,label:"Documents",color:"#F77C40",icon:"fa-book"},{count:(u=a==null?void 0:a.totalCount)==null?void 0:u.TOT_NO_OF_VIEW,label:"Views",color:"#2BAAE1",icon:"fa-eye"},{count:(f=a==null?void 0:a.totalCount)==null?void 0:f.TOT_NO_OF_DOWNLOAD,label:"Downloads",color:"#93C54A",icon:"fa-angles-down"}].map((s,t)=>e.jsx("div",{className:"col-sm-12 col-lg-3",children:e.jsx("div",{className:"card mb-3 py-3 card-hover-effect",style:{background:s.color,cursor:"pointer",boxShadow:"6px 6px 10px -1px rgba(0,0,0,0.15), -6px -6px 10px -1px rgba(255,255,255,0.7)"},children:e.jsxs("div",{className:"row g-0",children:[e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title font-weight-bold text-white",children:s.count}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-white",children:s.label})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx("i",{className:`fa-solid ${s.icon} pt-4 text-white`,style:{fontSize:"50px",opacity:"0.5"}})})]})})},t))}),e.jsxs("div",{className:"row py-3",children:[e.jsx("div",{className:"col-sm-12 col-lg-6",children:C?e.jsx("div",{className:"spinner-border mt-4",role:"status"}):e.jsx(g,{chartType:"ColumnChart",width:"100%",height:"350px",data:j,options:O})}),e.jsx("div",{className:"col-sm-12 col-lg-6",children:A?e.jsx("div",{className:"spinner-border mt-4",role:"status"}):e.jsx(g,{chartType:"PieChart",width:"100%",height:"350px",data:y,options:I})})]}),e.jsx("div",{className:"row",children:[{title:"Recently Added",dataKey:"recentData"},{title:"Most Viewed",dataKey:"mostViewData",badge:"primary"},{title:"Most Download",dataKey:"downloadData",badge:"success"}].map((s,t)=>{var i;return e.jsx("div",{className:"col-sm-12 col-lg-4",children:e.jsxs("div",{className:"card mb-3",style:{boxShadow:"6px 6px 10px -1px rgba(0,0,0,0.15), -6px -6px 10px -1px rgba(255,255,255,0.7)"},children:[e.jsx("h6",{className:"bg-black text-white p-2",children:s.title}),e.jsx("table",{className:"table table-hover",children:e.jsx("tbody",{children:(i=a==null?void 0:a[s.dataKey])==null?void 0:i.map((o,c)=>e.jsxs("tr",{style:{cursor:"pointer"},children:[e.jsx("td",{children:o.FILE_NAME}),s.badge&&e.jsx("td",{className:"px-0",children:e.jsx("span",{className:`badge bg-${s.badge}`,children:o.NO_OF_VIEW})}),e.jsx("td",{className:"px-0",children:e.jsx("a",{href:`${n}/static/public/image/${o.FILE_PATH}`,target:"_blank",rel:"noreferrer",children:e.jsx(M,{className:"fs-6 bg-danger",icon:e.jsx(V,{}),size:"small",style:{color:"#fff",fontSize:"5px"},onClick:()=>v(o.TRAN_DTL_ID,o.DTLS_FILE_NAME||o.FILE_NAME)})})})]},c))})})]})},t)})})]})};export{R as default};
