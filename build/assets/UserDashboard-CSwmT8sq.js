import{A as $,r as n,k,j as e}from"./index-CKztDtJy.js";import{a as h,b as i}from"./api-4LTkHDOH.js";import{C as g}from"./index-Bey2CDyB.js";import{B as M}from"./button-DLjvLRGX.js";import{R as P}from"./FilePdfOutlined-cois0AvM.js";import"./AntdIcon-D6PjId85.js";import"./compact-item-BzXGub8O.js";const G=()=>{var p,N,b,u;const r=$(),[m,f]=n.useState({}),[t,j]=n.useState(null),[y,_]=n.useState([]),[D,E]=n.useState([]),[w,C]=n.useState(!0),[v,O]=n.useState(!0),A=k();n.useEffect(()=>{if(r===!1){window.location.href="/login";return}},[r]),n.useEffect(()=>{const s=r.role;h.get(`${i}/admistration/roleaccessbyroleid/${s}`).then(o=>{o.data.data.some(a=>a.MODULE_MST_ID===7)||A("/dashboard")}).catch(o=>console.error("Role check error:",o.message))},[]),n.useEffect(()=>{r!=null&&r.employee_id&&h.get(`${i}/setting/employee/byId/${r.employee_id}`).then(s=>f(s.data.data[0])).catch(s=>alert(s.message))},[r]),n.useEffect(()=>{h.get(`${i}/userdeshboard/${r==null?void 0:r.employee_id}`).then(s=>j(s.data.data)).catch(s=>alert(s.message))},[]),n.useEffect(()=>{(async()=>{var o,l;try{const a=(await h.get(`${i}/deshboardUserChart/${r==null?void 0:r.employee_id}`)).data.data,x=((o=a==null?void 0:a.CategoryGraph)==null?void 0:o.length)>0?[["Document Type","Number of Files",{role:"style"}],...a.CategoryGraph.map((d,S)=>[d.DOC_TYPE_NAME||"Unknown",Number(d.NO_OF_FILES)||0,["#D9524E","#F77C40","#2BAAE1","#93C54A","#76a7fa"][S%5]])]:[["Document Type","Number of Files",{role:"style"}],["No Data",0,"#ccc"]];_(x),C(!1);const L=(l=a==null?void 0:a.departmentPie)==null?void 0:l.map(d=>[d.DEPT_NAME||"Unknown",Number(d.NO_OF_FILES)||0]);E([["Department","Number of Files"],...L||[]]),O(!1)}catch(c){alert(c.message)}})()},[]);const F=(s,o)=>{h.post(`${i}/deshboard/totalViewDownloadCount`,{FILE_ID:s,FILE_NAME:o,VIEW_YN:"Y",DOWNLOAD_YN:"N"})},I={title:"Document Types and File Counts",hAxis:{title:"Document Type"},vAxis:{title:"Number of Files"},legend:"none",chartArea:{width:"80%",height:"70%"}},T={title:"Files per Department",legend:{position:"right",alignment:"center"}};return r===!1||!t?e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsxs("div",{className:"container py-4",children:[e.jsxs("h4",{className:"text-primary mb-4",children:["Hello, ",m==null?void 0:m.EMP_NAME,"!"]}),e.jsx("div",{className:"row mb-4",children:[{count:(p=t==null?void 0:t.totalCount)==null?void 0:p.NO_OF_ACTIVE_USERS,label:"Users",bg:"danger",icon:"fa-users"},{count:(N=t==null?void 0:t.totalCount)==null?void 0:N.TOT_NO_OF_FILES,label:"Documents",bg:"warning",icon:"fa-book"},{count:(b=t==null?void 0:t.totalCount)==null?void 0:b.TOT_NO_OF_VIEW,label:"Views",bg:"info",icon:"fa-eye"},{count:(u=t==null?void 0:t.totalCount)==null?void 0:u.TOT_NO_OF_DOWNLOAD,label:"Downloads",bg:"success",icon:"fa-download"}].map((s,o)=>e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("div",{className:`card text-white bg-${s.bg} shadow h-100`,children:e.jsxs("div",{className:"card-body rounded-4 d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{children:s.count}),e.jsx("p",{className:"mb-0",children:s.label})]}),e.jsx("i",{className:`fas ${s.icon} fa-2x`,style:{opacity:.6}})]})})},o))}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:w?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"spinner-border"})}):e.jsx(g,{chartType:"ColumnChart",width:"100%",height:"350px",data:y,options:I})}),e.jsx("div",{className:"col-md-6",children:v?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"spinner-border"})}):e.jsx(g,{chartType:"PieChart",width:"100%",height:"350px",data:D,options:T})})]}),e.jsx("div",{className:"row",children:[{title:"Recently Added",key:"recentData"},{title:"Most Viewed",key:"mostViewData",badge:"primary"},{title:"Most Download",key:"downloadData",badge:"success"}].map((s,o)=>{var l,c;return e.jsx("div",{className:"col-md-4 mb-4",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-dark text-white",children:s.title}),e.jsx("div",{className:"card-body p-0",style:{height:"300px",overflowY:"auto"},children:e.jsx("table",{className:"table table-hover mb-0",children:e.jsxs("tbody",{children:[(l=t==null?void 0:t[s.key])==null?void 0:l.map((a,x)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.FILE_NAME}),s.badge&&e.jsx("td",{children:e.jsx("span",{className:`badge bg-${s.badge}`,children:a.NO_OF_VIEW})}),e.jsx("td",{children:e.jsx("a",{href:`${i}/static/public/image/${a.FILE_PATH}`,target:"_blank",rel:"noreferrer",onClick:()=>F(a.TRAN_DTL_ID,a.DTLS_FILE_NAME||a.FILE_NAME),children:e.jsx(M,{className:"bg-danger text-white",icon:e.jsx(P,{}),size:"small",style:{fontSize:"12px"}})})})]},x)),!((c=t==null?void 0:t[s.key])!=null&&c.length)&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center text-muted",children:"No data"})})]})})})]})},o)})})]})};export{G as default};
