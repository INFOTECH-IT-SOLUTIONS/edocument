import{r as t,j as e}from"./index-BTeMt0bn.js";import{a as d,b as n}from"./api-4LTkHDOH.js";import{l as M}from"./index-BwpK9Jcr.js";import{F as R,o as F,i as k}from"./paginationfunction-CUIDC4Fi.js";import{a as u}from"./cil-lock-locked-BfbzMxIA.js";import{f as O}from"./index-Dc4plWP7.js";import{C as $,a as P,b as B,c as V}from"./CModalTitle-Djobf6Wv.js";import{C as Y,a as U,b as H,c as C}from"./DefaultLayout-COYtoO96.js";import{R as W}from"./FilePdfOutlined-Ckvf7fcD.js";import{R as z}from"./CloudDownloadOutlined-PZ1Kpaxi.js";import{C as J}from"./CModalFooter-BEXFqZkg.js";import{B as G}from"./button-TQMUHxtX.js";import{R as K}from"./FolderViewOutlined-DknyoxJO.js";import"./AntdIcon-C60h6qUe.js";import"./compact-item-BhS0uAM4.js";import"./index.esm-qKqSDkPN.js";const he=()=>{const[i,b]=t.useState([]),[D,E]=t.useState(!0),x=t.useRef();M.useReactToPrint({content:()=>x.current,documentTitle:"All Document Report",onBeforeGetContent:()=>{},onAfterPrint:()=>{}});const[m,g]=t.useState([]),[_,w]=t.useState();t.useEffect(()=>{d.get(`${n}/setting/department`).then(s=>{const a=s.data.data;g(a)}).catch(s=>{alert(s.message)})},[]);const I=()=>{d.get(`${n}/mis/departmentdoc`,{headers:{departmentid:_}}).then(s=>{const a=s.data.data;b(a),E(!1)}).catch(s=>{alert(s.message)})},[f,h]=t.useState(!1),[l,L]=t.useState({}),[p,N]=t.useState([]),[c,j]=t.useState("");t.useEffect(()=>{if(l!=null&&l.details)if(!c)N(l.details);else{const s=l.details.filter(a=>{var o;return(o=a==null?void 0:a.DTLS_FILE_NAME)==null?void 0:o.toLowerCase().includes(c==null?void 0:c.toLowerCase())});N(s)}},[l,c,D]);const v=async s=>{try{const a=await d.get(s,{responseType:"blob",withCredentials:!0}),o=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=o;const y=s.split("/").pop();r.setAttribute("download",y),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(o)}catch(a){console.error("Error downloading the file:",a)}},A=(s,a)=>{const o={FILE_ID:s,FILE_NAME:a,VIEW_YN:"Y",DOWNLOAD_YN:"N"};d({method:"post",url:`${n}/deshboard/totalViewDownloadCount`,data:o}).then(r=>{})},T=(s,a)=>{const o={FILE_ID:s,FILE_NAME:a,VIEW_YN:"N",DOWNLOAD_YN:"Y"};d({method:"post",url:`${n}/deshboard/totalViewDownloadCount`,data:o}).then(r=>{})},S=[{title:"TYPE",className:"dark_bg ",dataIndex:"DOC_CAT"},{title:"PROJECT NAME",className:"dark_bg ",dataIndex:"PROJECT_NAME"},{title:"BRANCH NAME",className:"dark_bg ",dataIndex:"BRANCH_NAME"},{title:"DEPARTMENT",className:"dark_bg ",dataIndex:"DEPT_NAME"},{title:"POLICY",className:"dark_bg ",dataIndex:"POLICY_NO"},{title:"DOCUMENT NAME",className:"dark_bg ",dataIndex:"FILE_NAME"},{title:"Action",className:"dark_bg ",render:(s,a)=>e.jsx("div",{className:"text-center",children:e.jsx(G,{style:{backgroundColor:"#347928",color:"#fff"},onClick:()=>{h(!f),L(a),j("")},shape:"circle",icon:e.jsx(K,{})})})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-start",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("select",{className:"form-select form-control bba_documents-form-control",onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),(m==null?void 0:m.length)>0&&e.jsx(e.Fragment,{children:m.map((s,a)=>e.jsx("option",{value:s.DEPT_ID,children:s.DEPT_NAME}))})]})}),e.jsx("div",{className:"col-sm-4  ms-2",children:e.jsxs(u,{style:{backgroundColor:"#3C8DBC",color:"#fff"},onClick:()=>I(),children:[e.jsx(O,{})," Search"]})}),e.jsx("div",{className:"col-sm-4 "})]}),e.jsx("div",{className:"mt-4",ref:x,children:e.jsx("div",{className:"row ",children:e.jsx("div",{className:"col-md-12 ",children:e.jsx("div",{className:"table-responsive",children:e.jsx(R,{className:"table-striped",pagination:{total:i===void 0?0:i.length,showTotal:(s,a)=>`Showing ${a[0]} to ${a[1]} of ${s} entries`,showSizeChanger:!0,onShowSizeChange:F,itemRender:k},style:{overflowX:"auto"},columns:S,bordered:!0,dataSource:i===void 0?[]:i,rowKey:s=>s.COM_ID,onChange:console.log("change")})})})})})," ",l&&e.jsxs($,{visible:f,size:"lg",onClose:()=>h(!1),"aria-labelledby":"LiveDemoExampleLabel",children:[e.jsx(P,{onClose:()=>h(!1),children:e.jsx(B,{id:"LiveDemoExampleLabel",style:{fontFamily:"Segoe UI"},children:"View Document Files"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-6",children:[" ",e.jsx("div",{className:"",children:e.jsxs("div",{className:"position-relative",style:{marginLeft:"30px",marginBottom:"10px"},children:[e.jsx("i",{className:"fa fa-search position-absolute",style:{left:"10px",top:"50%",transform:"translateY(-50%)",color:"#999"}}),e.jsx("input",{onChange:s=>{j(s.target.value)},className:"form-control w-100 shadow ps-4 ms-1",type:"text",placeholder:"Search Here",style:{paddingLeft:"35px"}})]})})]}),e.jsx("div",{className:"col-sm-6"})]}),e.jsx("div",{className:"row px-5 py-1",children:e.jsxs("table",{class:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bgColor",scope:"col",children:"#"}),e.jsx("th",{className:"bgColor",scope:"col",children:"File"}),e.jsx("th",{className:"bgColor",scope:"col",children:"Action"})]})}),e.jsx("tbody",{children:p==null?void 0:p.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:++a}),e.jsx("td",{children:s.DTLS_FILE_NAME?s.DTLS_FILE_NAME:" "}),e.jsxs("td",{children:[" ",e.jsxs(Y,{className:"",children:[e.jsx(U,{style:{backgroundColor:"#3C8DBC",color:"#fff"},children:"Action"}),e.jsxs(H,{children:[e.jsxs(C,{onClick:()=>{A(s.TRAN_DTL_ID,s.DTLS_FILE_NAME)},href:`${n}/static/public/image/${s==null?void 0:s.FILE_PATH}`,target:"_blank",children:[e.jsx(W,{})," View"]}),e.jsxs(C,{style:{cursor:"pointer"},onClick:()=>{v(`${n}/static/public/image/${s==null?void 0:s.FILE_PATH}`),T(s.TRAN_DTL_ID,s.DTLS_FILE_NAME)},children:[e.jsx(z,{})," Download"]})]})]})]})]},a))})]})}),e.jsx("div",{className:"submit-section",children:e.jsx(J,{className:"justify-content-center",style:{borderTop:"none"},children:e.jsx(u,{color:"secondary",onClick:()=>h(!1),children:"Close"})})})]})]})]})};export{he as default};
